<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · GasChromatographySimulator.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="GasChromatographySimulator.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">GasChromatographySimulator.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../usage/">Usage</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Notebooks"><span>Notebooks</span></a></li><li><a class="tocitem" href="#Simulation-of-measurements"><span>Simulation of measurements</span></a></li></ul></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JanLeppert/GasChromatographySimulator.jl/blob/main/docs/src/examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Notebooks"><a class="docs-heading-anchor" href="#Notebooks">Notebooks</a><a id="Notebooks-1"></a><a class="docs-heading-anchor-permalink" href="#Notebooks" title="Permalink"></a></h2><p>In the folder <a href="https://github.com/JanLeppert/GasChromatographySimulator.jl/tree/main/notebooks">notebooks</a> several notebooks, using <a href="https://github.com/fonsp/Pluto.jl">Pluto.jl</a>, for the simulation of GC-systems are available. </p><p>To use these notebooks <a href="https://julialang.org/downloads/#current_stable_release">Julia, v1.6 or above,</a> must be installed and <strong>Pluto</strong> must be added:</p><pre><code class="language-julia hljs">julia&gt; ]
(v1.7) pkg&gt; add Pluto</code></pre><p>To run Pluto, use the following commands:</p><pre><code class="language-julia hljs">julia&gt; using Pluto
julia&gt; Pluto.run()</code></pre><p>Pluto will open your browser. In the field <code>Open from file</code> the URL of a notebook or the path to a locally downloaded notebook can be insert and the notebook will open and load the necessary packages. </p><h3 id="Overview-of-notebooks"><a class="docs-heading-anchor" href="#Overview-of-notebooks">Overview of notebooks</a><a id="Overview-of-notebooks-1"></a><a class="docs-heading-anchor-permalink" href="#Overview-of-notebooks" title="Permalink"></a></h3><ul><li><code>simulation_conventional_GC.jl</code> - simulation of a conventional GC-system (constant temperature, constant diameter and constant film thickness along the column) and outlet pressure as &quot;vacuum&quot; or &quot;atmospheric&quot;, now with option of flow or pressure control and temperature program notation in the typical form used in commercial GC software (temperature levels, holding times and heating ramps) </li><li><code>simulation_conventional_GC_load_2dbs.jl</code> - simulation of a conventional GC-system (constant temperature, constant diameter and constant film thickness along the column) and loading of up to two different substance databases and simulation of the common substances with the same GC-system and comparing the result. Also, an option is given, to load measured retention times and compare these to the simulations. Same setting for programs as in <code>simulation_conventional_GC.jl</code></li><li><code>simulation_example.jl</code> - general example of simulation of a GC-system with optional thermal gradient (exponential/linear model of temperature change along the column) and constant diameter and constant film thickness along the column. </li><li><code>simulation_example_input_gradient_function.jl</code> - simulation of a GC-system with optional thermal gradient where the temperature change along the column is defined by a user-defined equation (cosine-function as example)</li></ul><h2 id="Simulation-of-measurements"><a class="docs-heading-anchor" href="#Simulation-of-measurements">Simulation of measurements</a><a id="Simulation-of-measurements-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-of-measurements" title="Permalink"></a></h2><p>Two measurements from <a href="https://janleppert.github.io/GasChromatographySimulator.jl/dev/references/#References"><code>[8]</code></a> will be simulated and compared to the measured chromatograms. The n-alkanes from n-nonane (C9) to n-triacontane (C30) are separated in a conventional GC and a thermal gradient GC . The database with the thermodynamic parameters is <a href="https://github.com/JanLeppert/GasChromatographySimulator.jl/blob/main/data/Database_Leppert2020b.csv"><code>Database_Leppert2020b.csv</code></a>.</p><h3 id="Conventional-GC"><a class="docs-heading-anchor" href="#Conventional-GC">Conventional GC</a><a id="Conventional-GC-1"></a><a class="docs-heading-anchor-permalink" href="#Conventional-GC" title="Permalink"></a></h3><p>The conventional GC program simulated here is <code>Prog. D</code> from <a href="https://janleppert.github.io/GasChromatographySimulator.jl/dev/references/#References"><code>[8]</code></a>, a temperature program with two heating ramps, constant inlet pressure and a flame ionization detector (FID, atmospheric outlet pressure). </p><p>The standard options are used. Only the option <code>ng</code> (non-gradient) is changed to <code>true</code>. Because the conventional GC does not use non-uniform temperature, diameter or film thickness, the model can be simplified and the calculation of the separation is faster.</p><pre><code class="language-julia hljs">using DataFrames, CSV
opt = GasChromatographySimulator.Options(ng=true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GasChromatographySimulator.Options(OwrenZen5(), 1.0e-6, 0.001, &quot;inlet&quot;, true, true, &quot;Blumberg&quot;, &quot;Pressure&quot;)</code></pre><p>The column is defined as:</p><pre><code class="language-julia hljs">col = GasChromatographySimulator.Column(11.18, 0.104e-3, 0.104e-6, &quot;FS5ms&quot;, &quot;H2&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GasChromatographySimulator.Column(11.18, 0.000104, [0.000104], 1.04e-7, [1.04e-7], &quot;FS5ms&quot;, &quot;H2&quot;)</code></pre><p>The program is defined as:</p><pre><code class="language-julia hljs">prog_D = GasChromatographySimulator.Program([0.0, 60.0, 1680.0, 60.0, 360.0, 60.0], [40.0, 40.0, 180.0, 180.0, 300.0, 300.0], 411564.0*ones(6), 101300.0.*ones(6), col.L)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GasChromatographySimulator.Program{GasChromatographySimulator.var&quot;#gf#5&quot;{Matrix{Float64}}}([0.0, 60.0, 1680.0, 60.0, 360.0, 60.0], [40.0, 40.0, 180.0, 180.0, 300.0, 300.0], [411564.0, 411564.0, 411564.0, 411564.0, 411564.0, 411564.0], [101300.0, 101300.0, 101300.0, 101300.0, 101300.0, 101300.0], GasChromatographySimulator.var&quot;#gf#5&quot;{Matrix{Float64}}([0.0 0.0 11.18 0.0; 0.0 0.0 11.18 0.0; … ; 0.0 0.0 11.18 0.0; 0.0 0.0 11.18 0.0]), [0.0 0.0 11.18 0.0; 0.0 0.0 11.18 0.0; … ; 0.0 0.0 11.18 0.0; 0.0 0.0 11.18 0.0], 11181×6 extrapolate(interpolate((0.0:0.001:11.18,::Vector{Float64}), ::Matrix{Float64}, Gridded(Linear())), Flat()) with element type Float64:
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
   ⋮                                       ⋮
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15
 313.15  313.15  453.15  453.15  573.15  573.15, 6-element extrapolate(interpolate((::Vector{Float64},), ::Vector{Float64}, Gridded(Linear())), Flat()) with element type Float64:
 411564.0
 411564.0
 411564.0
 411564.0
 411564.0
 411564.0, 6-element extrapolate(interpolate((::Vector{Float64},), ::Vector{Float64}, Gridded(Linear())), Flat()) with element type Float64:
 101300.0
 101300.0
 101300.0
 101300.0
 101300.0
 101300.0)</code></pre><p>We want to use all solutes for the stationary phase FS5ms, which are in the database. We load the database into a dataframe:</p><pre><code class="language- hljs">db_dataframe = DataFrame(CSV.File(&quot;/../../data/Database_Leppert2020b.csv&quot;, header=1, silencewarnings=true))</code></pre><p>and extract all the names of the substances with:</p><pre><code class="language- hljs">solutes = GasChromatographySimulator.all_solutes(col.sp, db_dataframe)</code></pre><p>The data for all solutes is finally loaded with:</p><pre><code class="language- hljs">t₀ = 0.8.*ones(length(solutes))
τ₀ = zeros(length(solutes))
sub = GasChromatographySimulator.load_solute_database(db_dataframe, col.sp, col.gas, solutes, t₀, τ₀)</code></pre><p>Here the injection time <code>t₀</code> of all substances is set to 0.8s, because the autosampler used with the GC starts the temperature program shortly before injection. Otherwise the injection is assumed to be ideal with initial peak widths <code>τ₀</code> of 0 seconds.</p><p>The parameters are combined:</p><pre><code class="language- hljs">par = GasChromatographySimulator.Parameters(col, prog_D, sub, opt)</code></pre><p>And the simulation is run:</p><pre><code class="language- hljs">peaklist, sol = GasChromatographySimulator.simulate(par)</code></pre><p>THe file <a href="https://github.com/JanLeppert/GasChromatographySimulator.jl/blob/main/data/Leppert2020b_measured_RT_progD.csv"><code>Leppert2020b_measured_RT_progD.csv</code></a> contains the retention times and peak widths (as standard deviations) from the measured chromatogram.</p><pre><code class="language- hljs">measurement_D = DataFrame(CSV.File(&quot;/../../data/Leppert2020b_measured_RT_progD.csv&quot;, header=1, silencewarnings=true))
measurement_D = measurement_D[!, 2] .* 60.0 # conversion from min -&gt; s
rename!(measurement_D, [:Name, :tR, :τR])</code></pre><p>The simulated and measured separations can be compared by comparing the peak lists:</p><pre><code class="language- hljs">compare = GasChromatographySimulator.compare_peaklist(measurement_D, peaklist)</code></pre><p>or by comparing the chromatograms: <strong>PlotChromatograms</strong></p><h3 id="Thermal-gradient-GC"><a class="docs-heading-anchor" href="#Thermal-gradient-GC">Thermal gradient GC</a><a id="Thermal-gradient-GC-1"></a><a class="docs-heading-anchor-permalink" href="#Thermal-gradient-GC" title="Permalink"></a></h3><p><strong>here an example of a simulation of one of the thermal gradient measurements in Leppert2020b</strong> </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../usage/">« Usage</a><a class="docs-footer-nextpage" href="../functions/">Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Friday 5 August 2022 16:39">Friday 5 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
